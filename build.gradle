plugins {
  id "com.hkmc.h2" version "1.0.103"
}

group = "com.hkmc.ccs"
version = "1.0.28"

cloudnative {
  microservice {
    openfeign = true
    validate = true

  }

  persistent {
    jpa = true
    postgresql = true
    h2db = true
  }

  thirdparty {
    commonsLang = true
    commonsCollections = true
    prometheusRSocket = true
    jasypt = true
  }

  cicd {
    container {
      to = "registry.hcloud.hmc.co.kr/ccs/${project.name}"
//      jvmOption = "-XX:+UnlockExperimentalVMOptions -XX:+UseZGC -XX:InitialRAMPercentage=50 -XX:MinRAMPercentage=50 -XX:MaxRAMPercentage=75"
    }

    helm {
      name = "metering"
      namespace = "metering"
      servicePort = 8080
    }


    deploy {
      oldStyleNaming = true
      strategy = "BLUE-GREEN"

      targets = [
        [region: "ap-northeast", target: "dev", min: 1, max: 1],
        [region: "ap-northeast", target: "stg", min: 1, max: 1],
        [region: "ap-northeast", target: "prd", min: 12, max: 16]
      ]
    }
  }
}
